local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
local humanoid = character:WaitForChild("Humanoid")

-- Flight variables
local flightSpeed = 50
local isFlying = false
local flightVelocity = Vector3.new(0, 0, 0)

-- Invisibility variable
local isInvisible = false

-- Create a UI with scrolling list and buttons for cheats
local function createUI()
    -- Main UI container
    local screenGui = Instance.new("ScreenGui")
    screenGui.Parent = player:WaitForChild("PlayerGui")
    
    -- Frame for UI (Left side of the screen)
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 250, 0, 400)
    mainFrame.Position = UDim2.new(0, 0, 0.5, -200)
    mainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    mainFrame.BackgroundTransparency = 0.5
    mainFrame.Parent = screenGui

    -- Scrolling Frame for player list and cheat options
    local scrollFrame = Instance.new("ScrollingFrame")
    scrollFrame.Size = UDim2.new(1, 0, 1, 0)
    scrollFrame.Position = UDim2.new(0, 0, 0, 0)
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 500)  -- Make the frame scrollable
    scrollFrame.ScrollBarThickness = 8
    scrollFrame.Parent = mainFrame

    -- Layout for the items inside the scrolling frame
    local layout = Instance.new("UIListLayout")
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    layout.Parent = scrollFrame

    -- Add buttons to the scrollable menu
    local function createButton(name, callback)
        local button = Instance.new("TextButton")
        button.Size = UDim2.new(1, 0, 0, 50)
        button.Text = name
        button.TextColor3 = Color3.fromRGB(255, 255, 255)
        button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        button.Parent = scrollFrame

        button.MouseButton1Click:Connect(callback)
    end

    -- Function to make the player fly
    local function startFlying()
        if isFlying then return end
        isFlying = true

        -- Create a BodyVelocity to control the flight
        local bodyVelocity = Instance.new("BodyVelocity")
        bodyVelocity.MaxForce = Vector3.new(50000, 50000, 50000)
        bodyVelocity.Velocity = flightVelocity
        bodyVelocity.Parent = humanoidRootPart

        -- Keep the flight active
        while isFlying do
            bodyVelocity.Velocity = flightVelocity
            game:GetService("RunService").Heartbeat:Wait()
        end
    end

    -- Stop flying and remove the BodyVelocity
    local function stopFlying()
        isFlying = false
        for _, v in pairs(humanoidRootPart:GetChildren()) do
            if v:IsA("BodyVelocity") then
                v:Destroy()
            end
        end
    end

    -- Speed Hack (adjust WalkSpeed)
    local function setSpeed(speed)
        humanoid.WalkSpeed = speed
    end

    -- Function to make the player invisible
    local function setInvisibility(invisible)
        isInvisible = invisible
        for _, part in pairs(character:GetChildren()) do
            if part:IsA("BasePart") then
                -- Set transparency and disable collisions for all parts
                part.Transparency = invisible and 1 or 0
                part.CanCollide = not invisible
            end
        end

        -- Make the humanoid invisible as well (for the health bar, etc.)
        if character:FindFirstChild("Humanoid") then
            local humanoid = character.Humanoid
            humanoid.HealthDisplayType = invisible and Enum.HealthDisplayType.None or Enum.HealthDisplayType.Bar
        end
    end

    -- Function to create a list of other players
    local function updatePlayerList()
        local playerList = game.Players:GetPlayers()
        local playerNames = {}
        
        for _, p in pairs(playerList) do
            if p ~= player then
                table.insert(playerNames, p.Name)
            end
        end
        return playerNames
    end

    -- Add the player list to the scrollable menu
    local function addPlayerList()
        local playerNames = updatePlayerList()

        -- Player selection button
        local playerSelectionButton = Instance.new("TextButton")
        playerSelectionButton.Size = UDim2.new(1, 0, 0, 50)
        playerSelectionButton.Text = "Select Target Player"
        playerSelectionButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        playerSelectionButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        playerSelectionButton.Parent = scrollFrame

        playerSelectionButton.MouseButton1Click:Connect(function()
            -- Open a dropdown of players to select
            for _, playerName in pairs(playerNames) do
                createButton(playerName, function()
                    local targetPlayer = game.Players:FindFirstChild(playerName)
                    if targetPlayer then
                        teleportToPlayer(targetPlayer)  -- Teleport to selected player
                    end
                end)
            end
        end)
    end

    -- Add common cheat options
    createButton("Toggle Flight", function()
        if isFlying then
            stopFlying()  -- Stop flying if already flying
        else
            startFlying()  -- Start flying if not already flying
        end
    end)

    createButton("Toggle Speed", function()
        if humanoid.WalkSpeed == 16 then  -- Default speed in Roblox
            setSpeed(16 * 2)  -- Set increased speed
        else
            setSpeed(16)  -- Reset to normal speed
        end
    end)

    createButton("Toggle Invisibility", function()
        setInvisibility(not isInvisible)  -- Toggle invisibility
    end)

    createButton("Teleport to Random Player", function()
        local playerList = game.Players:GetPlayers()
        local targetPlayer = playerList[math.random(1, #playerList)]  -- Randomly select a player
        teleportToPlayer(targetPlayer)
    end)

    -- Add the player selection to the menu
    addPlayerList()
end

-- Create the UI
createUI()
